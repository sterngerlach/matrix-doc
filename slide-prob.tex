
% slide-prob.tex

\documentclass[dvipdfmx,notheorems,t]{beamer}

\usepackage{docmute}
\input{settings}

\title{行列輪講: 練習問題}
\author{杉浦 圭祐}
\institute[松谷研究室]{慶應義塾大学理工学部情報工学科 松谷研究室}
\date{\today}

% Always use the \displaystyle
\everymath{\displaystyle}

\begin{document}

\linespread{1.1}

\frame{\titlepage}

\section{練習問題}

\begin{frame}{第1回: 行列の基本処理, 逆行列}
\begin{enumerate}
  \item 以下の行列積の$(i, j)$成分を, 各行列の成分を用いて書いてください.
  \begin{gather*}
    \vb{A} \vb{B} \\
    \vb{A}^\top \vb{B} \\
    \vb{A} \vb{B} \vb{C} \\
    \vb{A} \vb{B} \vb{C} \vb{D} \\
    \vb{A} \vb{B}^\top \vb{C} \vb{D}^\top \\
    \vb{A}^n \\
    \text{例: } \left( \vb{A} \vb{B} \vb{A}^\top \right)_{ij} = \sum_k \sum_l a_{ik} b_{kl} a_{jl}
  \end{gather*}
  \item 対称行列, エルミート行列, 正定値行列, 直交行列, ユニタリ行列とは何か, 確認しましょう.
\end{enumerate}
\end{frame}

\begin{frame}{第1回: 行列の基本処理, 逆行列}
\begin{enumerate}
  \setcounter{enumi}{2}
  \item Sherman-Morrison-Woodburyの公式があります.
  どのようなときに, この公式が役に立つでしょうか.
  \begin{align*}
    \left( \vb{A}^{-1} + \vb{B} \vb{D}^{-1} \vb{C} \right)^{-1}
      &= \vb{A} - \vb{A} \vb{B}
        \left( \vb{D} + \vb{C} \vb{A} \vb{B} \right)^{-1} \vb{C} \vb{A}
  \end{align*}
  \item 上式から, 以下の式を導出してください.
  \begin{align*}
    \left( \vb{A} + \vb{b} \vb{c}^\top \right)^{-1}
      &= \vb{A}^{-1} - \frac{\vb{A}^{-1} \vb{b} \vb{c}^\top \vb{A}^{-1}}{1 + \vb{c}^\top \vb{A}^{-1} \vb{b}}
  \end{align*}
  \item シューア補行列による以下の式を, 確認してください.
  \begin{align*}
    \mqty(\vb{A} & \vb{B} \\ \vb{C} & \vb{D})
      &= \mqty(\vb{I} & \vb{0} \\ \vb{C} \vb{A}^{-1} & \vb{I})
        \mqty(\dmat[\vb{0}]{\vb{A}, \vb{D} - \vb{C} \vb{A}^{-1} \vb{B}})
        \mqty(\vb{I} & \vb{A}^{-1} \vb{B} \\ \vb{0} & \vb{I})
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第2回: 行列式, トレース}
\begin{enumerate}
  \item 同じ列ベクトルを2箇所に含んだ行列の, 行列式が$0$になることを確認してください.
  \begin{align*}
    \det(\mqty(\vb{a}_1, \ldots, \vb{a}_i, \ldots, \vb{a}_i, \ldots, \vb{a}_n)) = 0
  \end{align*}
  \item $n$次正方行列$\vb{A}$を$c$倍したとき, 行列式は元の$c^n$倍になることを確認してください (置換による行列式の定義を用いる).
  \begin{align*}
    \det(c \vb{A}) = c^n \det(\vb{A})
  \end{align*}
  \item 上を用いて, $i$列目に$j$列目の$c$倍を足しても ($i \neq j$), 行列式が変わらないことを確認してください.
  \begin{align*}
    & \det(\mqty(\vb{a}_1, \ldots, \vb{a}_i + c \vb{a}_j, \ldots, \vb{a}_j, \ldots, \vb{a}_n)) \\
      &= \det(\mqty(\vb{a}_1, \ldots, \vb{a}_i, \ldots, \vb{a}_j, \ldots, \vb{a}_n))
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第2回: 行列式, トレース}
\begin{enumerate}
  \setcounter{enumi}{3}
  \item 以下を確認してください (1行目から2行目を引き, 2列目に1列目を足す).
  \begin{align*}
    \det\left( \mqty(\vb{A} & \vb{B} \\ \vb{B} & \vb{A}) \right)
      &= \det(\vb{A} + \vb{B}) \det(\vb{A} - \vb{B})
  \end{align*}
  \item 以下を確認してください.
  $\vb{A}$の余因子行列$\adj \vb{A}$, 行列式$\det(\vb{A})$, 逆行列$\vb{A}^{-1}$について,
  \begin{align*}
    \left( \adj \vb{A} \right) \vb{A} = \left( \det(\vb{A}) \right) \vb{I}
  \end{align*}
  \item 以下を確認してください.
  \begin{align*}
    \tr(\vb{X}^{-1} \vb{A} \vb{X}) = \tr(\vb{A})
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第3回: 行列とベクトルの微分1}
\begin{enumerate}
  \item $\vb{x}, \vb{y}$を$n$, $m$次縦ベクトルとします.
  以下の微分の形 (サイズ) を確認しましょう.
  分子レイアウト, 分母レイアウトの双方で考えてください.
  \begin{align*}
    \pdv{\vb{y}}{x}, \ \pdv{y}{\vb{x}}, \ \pdv{\vb{y}}{\vb{x}}
  \end{align*}

  \item 以下を確認してください (成分ごとに書き下す).
  \begin{align*}
    \pdv{\vb{a}^\top \vb{x}}{\vb{x}} &= \pdv{\vb{x}^\top \vb{a}}{\vb{x}} = \vb{a}^\top
  \end{align*}

  \item 以下を確認してください ($\pdv{\vb{x}^\top \vb{A} \vb{x}}{\vb{x}} =
  \vb{x}^\top \left( \vb{A} + \vb{A}^\top \right)$を用いる).
  \begin{align*}
    \pdv{\left( \vb{a}^\top \vb{x} \right) \left( \vb{b}^\top \vb{x} \right)}{\vb{x}}
      &= \vb{x}^\top \left( \vb{a} \vb{b}^\top + \vb{b} \vb{a}^\top \right)
      & \text{($\vb{a}, \vb{b}$は定数)}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第3回: 行列とベクトルの微分1}
\begin{enumerate}
  \setcounter{enumi}{3}
  \item 以下を確認してください ($\vb{A}, \vb{B}, \vb{C}$は定数, $\vb{C}$は対称行列).
  \begin{align*}
    \pdv{\left( \vb{x} - \vb{A} \vb{b} \right)^\top \vb{C} \left( \vb{x} - \vb{A} \vb{b} \right)}{\vb{x}}
      = 2 \left( \vb{x} - \vb{A} \vb{b} \right)^\top \vb{C}
  \end{align*}

  \item 以下を確認してください ($\vb{A}, \vb{B}, \vb{C}$は定数, $\vb{C}$は対称行列).
  \begin{align*}
    \pdv{\left( \vb{b} - \vb{A} \vb{x} \right)^\top \vb{C} \left( \vb{b} - \vb{A} \vb{x} \right)}{\vb{x}}
      = -2 \left( \vb{b} - \vb{A} \vb{x} \right)^\top \vb{C} \vb{A}
  \end{align*}
  上の2つの導出では, 以下の式を用いること.
  \begin{align*}
    \pdv{\left( \vb{x} + \vb{A} \vb{b} \right)^\top \vb{C} \left( \vb{x} + \vb{D} \vb{e} \right)}{\vb{x}}
    = \left( \vb{x} + \vb{A} \vb{b} \right)^\top \vb{C}
      + \left( \vb{x} + \vb{D} \vb{e} \right)^\top \vb{C}^\top
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第3回: 行列とベクトルの微分1}
\begin{enumerate}
  \setcounter{enumi}{5}
  \item 以下を確認してください (成分ごとに書き下す).
  \begin{align*}
    \pdv{\vb{A} \vb{u}}{\vb{x}} &= \vb{A} \pdv{\vb{u}}{\vb{x}}
      & \text{($\vb{u} = \vb{u}(\vb{x})$, $\vb{A}$は定数)}
  \end{align*}

  \item 分子レイアウトに関する以下の式を, 分母レイアウトに直してください.
  \begin{align*}
    \pdv{\vb{A} \vb{u}}{x} &= \vb{A} \pdv{\vb{u}}{x} \\
    \pdv{\left( \vb{A} \vb{x} + \vb{b} \right)^\top \vb{C} \left( \vb{D} \vb{x} + \vb{e} \right)}{\vb{x}}
      &= \left( \vb{D} \vb{x} + \vb{e} \right)^\top \vb{C}^\top \vb{A}
      + \left( \vb{A} \vb{x} + \vb{b} \right)^\top \vb{C} \vb{D} \\
    \pdv{\left( \vb{x} - \vb{b} \right)^\top \vb{C} \left( \vb{x} - \vb{b} \right)}{\vb{x}}
      &= 2 \left( \vb{x} - \vb{b} \right)^\top \vb{C} \\
    \pdv{\vb{g}(\vb{u})}{\vb{x}} &= \pdv{\vb{g}(\vb{u})}{\vb{u}} \pdv{\vb{u}}{\vb{x}}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第4回: 行列とベクトルの微分2}
\begin{enumerate}
  \item 2次元の回転行列$\vb{R}(\theta)$と, その逆行列$\vb{R}(\theta)^{-1}$は, 次のように表される.
  \begin{align*}
    \vb{R}(\theta) = \mqty(\cos \theta & -\sin \theta \\ \sin \theta & \cos \theta), \quad
    \vb{R}(\theta)^{-1} = \mqty(\cos \theta & \sin \theta \\ -\sin \theta & \cos \theta)
  \end{align*}
  $\vb{R}(\theta)^{-1} = \vb{R}(\theta)^\top = \vb{R}(-\theta)$であることを確認してください.
  また, $\displaystyle \pdv{\vb{R}(\theta)^{-1}}{\theta}$を2通りの方法で求めてください
  (上式を直接微分する方法と, 逆行列の微分の式を用いる方法).
  \begin{align*}
    \pdv{\vb{U}^{-1}}{x} &= -\vb{U}^{-1} \pdv{\vb{U}}{x} \vb{U}^{-1}
      & \text{($\vb{U} = \vb{U}(x)$)}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第4回: 行列とベクトルの微分2}
\begin{enumerate}
  \setcounter{enumi}{1}
  \item 2次元の回転行列を用いた, 次のような式を考える (2次元ロボットの動作を記述している).
  \begin{align*}
    \mqty(x' \\ y' \\ \theta')
      = \mqty(x \\ y \\ \theta)
        + \mqty(\vb{R}(\theta) & \vb{0} \\ \vb{0}^\top & 1)
          \mqty(u \\ v \\ \omega)
      = \mqty(x + u \cos \theta - v \sin \theta \\
        y + u \sin \theta + v \cos \theta \\ \theta + \omega)
  \end{align*}
  $\vb{x}' = \mqty(x' & y' & \theta)^\top$, $\vb{x} = \mqty(x & y & \theta)^\top$,
  $\vb{u} = \mqty(u & v & \omega)^\top$としたとき,
  $\displaystyle \pdv{\vb{x}'}{\vb{x}}$と$\displaystyle \pdv{\vb{x}'}{\vb{u}}$を求めてください.
\end{enumerate}

\begin{itemize}
  \item 2次元ロボットの姿勢推定を拡張カルマンフィルタで行うとき, 必要になる微分です.
\end{itemize}
\end{frame}

\begin{frame}{第4回: 行列とベクトルの微分2}
\begin{enumerate}
  \setcounter{enumi}{2}
  \item 以下を確認してください.
  \begin{align*}
    \pdv{\left( \vb{X}^\top \vb{a} \right)^\top \vb{X}^\top \vb{b}}{\vb{X}}
      &= \pdv{\vb{a}^\top \vb{X} \vb{X}^\top \vb{b}}{\vb{X}}
      = \vb{X}^\top \left( \vb{a} \vb{b}^\top + \vb{b} \vb{a}^\top \right)
      & \text{($\vb{a}, \vb{b}$は定数)}
  \end{align*}

  \item 以下を確認してください.
  \begin{align*}
    \pdv{\tr(\vb{X} \vb{A} \vb{X}^\top)}{\vb{X}} = \pdv{\tr(\vb{A} \vb{X}^\top \vb{X})}{\vb{X}}
      = \pdv{\tr(\vb{X}^\top \vb{X} \vb{A})}{\vb{X}}
      = \left( \vb{A} + \vb{A}^\top \right) \vb{X}^\top \\
      \text{($\vb{A}$は定数)}
  \end{align*}

  \item 以下を確認してください.
  \begin{align*}
    \pdv{\tr(\vb{A} \vb{X} \vb{B} \vb{X}^\top \vb{C})}{\vb{X}}
      &= \vb{B} \vb{X}^\top \vb{C} \vb{A} + \vb{B}^\top \vb{X}^\top \vb{A}^\top \vb{C}^\top
      & \text{($\vb{A}, \vb{B}, \vb{C}$は定数)}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第4回: 行列とベクトルの微分2}
\begin{enumerate}
  \setcounter{enumi}{5}
  \item 以下の微分を, $\pdv{\vb{Y}}{x}$, $\vb{Y}^{-1}$, $\vb{A}$, $\vb{B}$, $\vb{C}$を用いて表してください.
  \begin{align*}
    \pdv{\left( \vb{Y}^{-1} \vb{A} + \vb{B} \right)^{-1} \vb{C} \left( \vb{Y}^{-1} \vb{A} + \vb{B} \right)^{-1}}{x}
    \quad \text{($\vb{A}, \vb{B}, \vb{C}$は定数, $\vb{Y} = \vb{Y}(x)$)}
  \end{align*}

  \item 以下を確認してください.
  \begin{align*}
    \pdv{\exp(x \vb{A})}{x} = \vb{A} \exp(x \vb{A}) = \exp(x \vb{A}) \vb{A}
  \end{align*}
  ただし, $\exp(\vb{A})$は行列指数関数で, 次のように定義されます.
  \begin{align*}
    \exp(\vb{A}) \equiv \sum_{n = 0}^\infty \frac{1}{n!} \vb{A}^n
      = \vb{I} + \vb{A} + \frac{1}{2!} \vb{A}^2 + \frac{1}{3!} \vb{A}^3 + \cdots
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第5回: 行列とベクトルの微分3}
\begin{enumerate}
  \item 以下を確認してください.
  \begin{align*}
    \pdv{\det(a \vb{X})}{\vb{X}}
      &= a \adj \left( a \vb{X} \right) = \det(a \vb{X}) \vb{X}^{-1} & \text{($a$は定数)}
  \end{align*}

  \item 以下を確認してください. $\vb{A}, \vb{B}$が正方行列であるとき,
  \begin{align*}
    \pdv{\det(\vb{A} \vb{X} \vb{B})}{\vb{X}} &= \det(\vb{A} \vb{X} \vb{B}) \vb{X}^{-1}
      & \text{($\vb{A}, \vb{B}$は定数)}
  \end{align*}

  \item 以下を確認してください. $\vb{A}$が対称行列であるとき,
  \begin{align*}
    \pdv{\det(\vb{X}^\top \vb{A} \vb{X})}{\vb{X}}
      &= 2 \det(\vb{X}^\top \vb{A} \vb{X})
        \left( \vb{X}^\top \vb{A} \vb{X} \right)^{-1} \vb{X}^\top \vb{A}
      & \text{($\vb{A}$は定数)}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第5回: 行列とベクトルの微分3}
\begin{enumerate}
  \setcounter{enumi}{3}
  \item 2次元の回転行列$\vb{R}(\theta)$について, $\pdv{\det(\vb{R}(\theta))}{\theta}$を計算し,
  ヤコビの公式を確認してください.
  \begin{align*}
    \vb{R}(\theta) = \mqty(\cos \theta & -\sin \theta \\ \sin \theta & \cos \theta), \quad
    \vb{R}(\theta)^{-1} = \mqty(\cos \theta & \sin \theta \\ -\sin \theta & \cos \theta)
  \end{align*}
  ただし, 2次正方行列$\vb{A} = \mqty(a_{11} & a_{12} \\ a_{21} & a_{22})$に対する行列式は,
  $\det(\vb{A}) = a_{11} a_{22} - a_{12} a_{21}$です.
\end{enumerate}
\end{frame}

\begin{frame}{第5回: 行列とベクトルの微分3}
\begin{enumerate}
  \setcounter{enumi}{4}
  \item 疑似逆行列に関する, 次の微分を確認してください.
  行列$\vb{U}$は, $x$の関数であるとします.
  \begin{align*}
    \pdv{\vb{U}^\dagger}{x} &\equiv
      \pdv{\left( \vb{U}^\top \vb{U} \right)^{-1} \vb{U}^\top}{x} \\
    &= -\left( \vb{U}^\top \vb{U} \right)^{-1} \pdv{\vb{U}^\top}{x} \vb{U} \vb{U}^\dagger
      - \vb{U}^\dagger \pdv{\vb{U}}{x} \vb{U}^\dagger
      + \left( \vb{U}^\top \vb{U} \right)^{-1} \pdv{\vb{U}^\top}{x}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第5回: 行列とベクトルの微分3}
\begin{enumerate}
  \setcounter{enumi}{5}
  \item ガウス分布$\mathcal{N}(\vb{x} \mid \vb*{\mu}, \vb{\Sigma})$の,
  平均$\vb*{\mu}$, 共分散の逆行列$\vb{\Sigma}^{-1}$, 共分散$\vb{\Sigma}$に関する,
  次の微分を確認してください (自然対数$\ln$に注意).
  \begin{align*}
    \pdv{\vb*{\mu}} \ln \mathcal{N}(\vb{x} \mid \vb*{\mu}, \vb{\Sigma})
    &= -\left( \vb{x} - \vb*{\mu} \right)^\top \vb{\Sigma}^{-1} \\
    \pdv{\vb{\Sigma}^{-1}} \ln \mathcal{N}(\vb{x} \mid \vb*{\mu}, \vb{\Sigma})
    &= \frac{1}{2} \left( \vb{\Sigma}
      - \left( \vb{x} - \vb*{\mu} \right) \left( \vb{x} - \vb*{\mu} \right)^\top \right) \\
    \pdv{\vb{\Sigma}} \ln \mathcal{N}(\vb{x} \mid \vb*{\mu}, \vb{\Sigma})
    &= -\frac{1}{2} \vb{\Sigma}^{-1} \left( \vb{I}
      - \left( \vb{x} - \vb*{\mu} \right) \left( \vb{x} - \vb*{\mu} \right)^\top
      \vb{\Sigma}^{-1} \right)
  \end{align*}
  ただし, ガウス分布$\mathcal{N}(\vb{x} \mid \vb*{\mu}, \vb{\Sigma})$は次のように定義されます.
  \begin{align*}
    \mathcal{N}(\vb{x} \mid \vb*{\mu}, \vb{\Sigma})
      \equiv \frac{1}{\left( 2\pi \right)^\frac{D}{2} \sqrt{\det \vb{\Sigma}}}
      \exp(-\frac{1}{2} \left( \vb{x} - \vb*{\mu} \right)^\top \vb{\Sigma}^{-1}
        \left( \vb{x} - \vb*{\mu} \right))
  \end{align*}
  $\vb{\Sigma}$に関する微分では, トレースの循環性を思い出しましょう.
\end{enumerate}
\end{frame}

\begin{frame}{第6回: 確率分布, ガウス積分}
\begin{enumerate}
  \item 変数$\vb{x}$と, ある定数$\vb{A}$について, 次が成り立つことを, 要素ごとに確認してください.
  \begin{align*}
    \E{\vb{A} \vb{x}} = \vb{A} \E{\vb{x}}, \quad
    \E{\vb{x} \vb{A}} = \E{\vb{x}} \vb{A}
  \end{align*}

  \item 確率分布$p(\vb{x})$の共分散が$\vb{\Sigma} = \Var{\vb{x}}$であるとき,
  $\vb{y} = \vb{A} \vb{x}$の分布$p(\vb{y})$の共分散が$\vb{A} \vb{\Sigma} \vb{A}^\top$となることを示してください.

  \item 確率分布$p(\vb{x})$の共分散$\vb{\Sigma} = \Var{\vb{x}}$について, 次が成り立つことを示してください.
  \begin{align*}
    \vb{\Sigma} &= \Var{\vb{x}} = \E{\vb{x} \vb{x}^\top} - \E{\vb{x}} \E{\vb{x}}^\top
      = \E{\vb{x} \vb{x}^\top} - \vb*{\mu} \vb*{\mu}^\top
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第6回: 確率分布, ガウス積分}
\begin{enumerate}
  \setcounter{enumi}{3}
  \item $\vb{x}, \vb{y}$が独立, すなわち$p(\vb{x}, \vb{y}) = p(\vb{x}) p(\vb{y})$であれば,
  無相関, すなわち$\E{\vb{x} \vb{y}^\top} = \E{\vb{x}} \E{\vb{y}}^\top$となることを示してください.

  \item 次を示してください.
  \begin{align*}
    & \E{\left( \vb{A} \vb{x} + \vb{b} \right) \left( \vb{C} \vb{x} + \vb{d} \right)^\top} \\
    &= \vb{A} \Var{\vb{x}} \vb{C}^\top
    + \left( \vb{A} \E{\vb{x}} + \vb{b} \right)
      \left( \vb{C} \E{\vb{x}} + \vb{d} \right)^\top
  \end{align*}

  \item カルバック--ライブラーダイバージェンスが非負, すなわち$\KL{p}{q} \ge 0$となることを示してください.

  \item エントロピーと相互情報量に関する, 次の式を示してください.
  \begin{align*}
    \MutualInfo{\vb{x}, \vb{y}} &= \Entropy{\vb{x}} + \Entropy{\vb{y}} - \Entropy{\vb{x}, \vb{y}}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第6回: 確率分布, ガウス積分}
\begin{enumerate}
  \setcounter{enumi}{7}
  \item 次の積分を求めてください.
  \begin{align*}
    \int_0^\infty x^4 \exp(-a x^2) \dd{x}, \quad \int_0^\infty x^5 \exp(-a x^2) \dd{x}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第7回: ガウス分布1}
\begin{enumerate}
  \item 次の積分を計算してください:
  \begin{align*}
    \int_{-\infty}^\infty (x - \mu)^2
      \exp \left( -\frac{1}{2 \sigma^2} \left( x - \mu \right)^2 \right) \dd{x}
  \end{align*}

  \item ガウス分布$\mathcal{N}(x \mid \mu, \sigma^2)$のモーメント母関数$M_X(t) = \E{\exp(tX)}$について,
  $\exp(\cdot)$の中身を平方完成させてください:
  \begin{align*}
    M_X(t) = \E{\exp(tX)} = \int_{-\infty}^\infty \frac{1}{\sqrt{2\pi \sigma^2}}
      \exp(tx -\frac{1}{2 \sigma^2} \left( x - \mu \right)^2) \dd{x}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第7回: ガウス分布1}
\begin{enumerate}
  \setcounter{enumi}{2}
  \item モーメント母関数を使って, ガウス分布の平均と分散を求めてください.
  \begin{align*}
    \E{x} &= \left. \dv{t} \exp(\mu t + \frac{\sigma^2 t^2}{2}) \right|_{t = 0} \\
    \E{x^2} &= \left. \dv[2]{t} \exp(\mu t + \frac{\sigma^2 t^2}{2}) \right|_{t = 0} \\
    \Var{x} &= \E{x^2} - \E{x}^2
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第7回: ガウス分布1}
\begin{enumerate}
  \setcounter{enumi}{3}
  \item ガウス分布$\mathcal{N}(\vb{x} \mid \vb*{\mu}, \vb{\Sigma})$の
  モーメント母関数$M_{\vb{X}}(\vb{t}) = \E{\exp(\vb{t}^\top \vb{X})}$について,
  $\exp(\cdot)$の中身を平方完成させてください:
  \begin{align*}
    & M_{\vb{X}}(\vb{t}) = \E{\exp(\vb{t}^\top \vb{x})} \\
    &= \frac{1}{\left( 2\pi \right)^\frac{D}{2} \sqrt{\det \vb{\Sigma}}}
      \int_{-\boldsymbol{\infty}}^{\boldsymbol{\infty}}
      \exp(-\frac{1}{2} \left( \vb{x} - \vb*{\mu} \right)^\top \vb{\Sigma}^{-1}
        \left( \vb{x} - \vb*{\mu} \right) + \vb{t}^\top \vb{x}) \dd{\vb{x}}
  \end{align*}
  ヒントはスライドに載っているので, 適宜参考にしてください.
\end{enumerate}
\end{frame}

\begin{frame}{第7回: ガウス分布1}
\begin{enumerate}
  \setcounter{enumi}{4}
  \item モーメント母関数を使って, 多変量ガウス分布の平均と共分散を求めてください.
  \begin{align*}
    \E{\vb{x}}^\top
    &= \left. \dv{\vb{t}} \exp(\vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t})
      \right|_{\vb{t} = \vb{0}} \\
    \E{\vb{x} \vb{x}^\top}
    &= \left. \frac{\dd[2]}{\dd{\vb{t}^\top} \dd{\vb{t}}}
      \exp(\vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t})
      \right|_{\vb{t} = \vb{0}} \\
    \Var{\vb{x}} &= \E{\vb{x} \vb{x}^\top} - \E{\vb{x}} \E{\vb{x}}^\top
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第8回: ガウス分布2}
\begin{enumerate}
  \item $\vb{x}$, $\vb{y}$は互いに\textcolor{red}{独立}で,
  ガウス分布$\mathcal{N}(\vb*{\mu}_x, \vb{\Sigma}_{xx})$,
  $\mathcal{N}(\vb*{\mu}_y, \vb{\Sigma}_{yy})$に従うとき,
  和$\vb{z} = \vb{A} \vb{x} + \vb{B} \vb{y}$が次のガウス分布に従うことを示してください.
  \begin{align*}
    \vb{z} \sim \mathcal{N}(\vb{A} \vb*{\mu}_x + \vb{B} \vb*{\mu}_y,
      \vb{A} \vb{\Sigma}_{xx} \vb{A}^\top + \vb{B} \vb{\Sigma}_{yy} \vb{B}^\top)
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第8回: ガウス分布2}
\begin{enumerate}
  \setcounter{enumi}{1}
  \item $K$個の独立な確率変数$\vb{x}_k$があり, ガウス分布$\mathcal{N}(\vb*{\mu}_k, \vb{\Sigma}_k)$に従うとき,
  重み付き和$\vb{x} = \sum_k w_k \vb{x}_k$が, 次のガウス分布に従うことを示してください.
  \begin{align*}
    \vb{x} \sim \mathcal{N} \left( \sum_k w_k \vb*{\mu}_k, \sum_k w_k^2 \vb{\Sigma}_k \right)
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第8回: ガウス分布2}
\begin{enumerate}
  \setcounter{enumi}{2}
  \item 次が成り立つことを示してください:
  \begin{align*}
    & \prod_k \exp(-\frac{1}{2} \left( \vb{G}_k \vb{x} - \vb*{\mu}_k \right)^\top
      \vb{\Sigma}_k^{-1} \left( \vb{G}_k \vb{x} - \vb*{\mu}_k \right)) \\
    & \qquad \propto \exp(-\frac{1}{2} \left( \vb{x} - \vb*{\mu} \right) \vb{\Sigma}^{-1}
      \left( \vb{x} - \vb*{\mu} \right))
  \end{align*}
  ただし,
  \begin{align*}
    \vb{\Sigma}^{-1} &= \sum_k \vb{G}_k^\top \vb{\Sigma}_k^{-1} \vb{G}_k \\
    \vb{\Sigma}^{-1} \vb*{\mu} &= \sum_k \vb{G}_k^\top \vb{\Sigma}_k^{-1} \vb*{\mu}_k
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第9回: ガウス分布3}
\begin{enumerate}
  \item ガンマ関数$\Gamma(x)$について, 部分積分により次を示してください:
  \begin{align*}
    \Gamma(x + 1) &= x \Gamma(x)
  \end{align*}
  これより, $x$が整数であれば, $\Gamma(x + 1) = x!$が成り立つ.
\end{enumerate}
\end{frame}

\begin{frame}{第9回: ガウス分布3}
\begin{enumerate}
  \setcounter{enumi}{1}
  \item $D = 4, 5$次元超球の体積$V_D(r)$と表面積$S_D(r)$を求めてください.
\end{enumerate}
\end{frame}

\begin{frame}{第9回: ガウス分布3}
\begin{enumerate}
  \item $D = 2$次元のガウス分布$\mathcal{N}(\vb{x} \mid \vb{0}, \sigma^2 \vb{I})$について,
  次の積分を考えることにより, $\vb{x}$の半径$r = \left\| \vb{x} \right\|$に関する
  レイリー分布$p(r)$を導出してください.
  \begin{align*}
    1 = \int_{\boldsymbol{-\infty}}^{\boldsymbol{\infty}}
      \mathcal{N}(\vb{x} \mid \vb{0}, \sigma^2 \vb{I}) \dd{\vb{x}}
      = \int_0^\infty p(r) \dd{r}
  \end{align*}
  ただし,
  \begin{align*}
    \mathcal{N}(\vb{x} \mid \vb{0}, \sigma^2 \vb{I})
      &= \frac{1}{2\pi \sigma^2} \exp(-\frac{1}{2 \sigma^2} \vb{x}^\top \vb{x})
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{}
\end{frame}

\section{解答}

\begin{frame}{第1回: 行列の基本処理, 逆行列}
\begin{enumerate}
  \item 以下のようになる.
  \begin{align*}
    \left( \vb{A} \vb{B} \right)_{ij} &= \sum_k a_{ik} b_{kj} \\
    \left( \vb{A}^\top \vb{B} \right)_{ij} &= \sum_k a_{ki} b_{kj} \\
    \left( \vb{A} \vb{B} \vb{C} \right)_{ij} &= \sum_k \sum_m a_{ik} b_{km} c_{mj} \\
    \left( \vb{A} \vb{B} \vb{C} \vb{D} \right)_{ij}
      &= \sum_k \sum_m \sum_n a_{ik} b_{km} c_{mn} d_{nk} \\
    \left( \vb{A} \vb{B}^\top \vb{C} \vb{D}^\top \right)_{ij}
      &= \sum_k \sum_m \sum_n a_{ik} b_{mk} c_{mn} d_{kn} \\
    \left( \vb{A}^n \right)_{ij}
      &= \sum_{u_1} \sum_{u_2} \cdots \sum_{u_{n - 1}}
        a_{i, u_1} a_{u_1, u_2} \cdots a_{u_{n - 2}, u_{n - 1}} a_{u_{n - 1}, j}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第1回: 行列の基本処理, 逆行列}
\begin{enumerate}
  \setcounter{enumi}{1}
  \item 省略.
  \item $\vb{A}, \vb{B}, \vb{C}, \vb{D}$を, $m \times m$, $m \times n$, $n \times m$, $n \times n$行列とする.
  ここで$m \gg n$とすると, 左辺を計算するためには, 大きな$m$次行列の逆行列が必要である.
  一方, 左辺の代わりに右辺を計算することにすれば, 小さな$n$次行列の逆行列を求めるだけでよい.
  \begin{align*}
    \left( \vb{A}^{-1} + \vb{B} \vb{D}^{-1} \vb{C} \right)^{-1}
      &= \vb{A} - \vb{A} \vb{B}
        \left( \vb{D} + \vb{C} \vb{A} \vb{B} \right)^{-1} \vb{C} \vb{A}
  \end{align*}
  \item 省略.
  \item 省略.
\end{enumerate}
\end{frame}

\begin{frame}{第2回: 行列式, トレース}
\begin{enumerate}
  \item $\lambda = \det(\mqty(\vb{a}_1, \ldots, \vb{a}_i, \ldots, \vb{a}_i, \ldots, \vb{a}_n))$とする.
  列を交換すると, 行列式の符号は反転する.
  しかし, 列を交換しても, 元と同じ行列であるから, $\lambda = -\lambda$である.
  よって, $\lambda = 0$である.
  \item 省略.
  \item 以下のように示せる.
  最初の式変形では, 列の線形変換と行列式との関係を用いる.
  最後の式変形では, 同じ列を含んでいれば行列式が$0$となることを用いる.
  {\small \begin{align*}
    & \det(\mqty(\vb{a}_1, \ldots, \vb{a}_i + c \vb{a}_j, \ldots, \vb{a}_j, \ldots, \vb{a}_n)) \\
    &= \det(\mqty(\vb{a}_1, \ldots, \vb{a}_i, \ldots, \vb{a}_j, \ldots, \vb{a}_n))
      + c \det(\mqty(\vb{a}_1, \ldots, \vb{a}_j, \ldots, \vb{a}_j, \ldots, \vb{a}_n)) \\
    &= \det(\mqty(\vb{a}_1, \ldots, \vb{a}_i, \ldots, \vb{a}_j, \ldots, \vb{a}_n))
  \end{align*}}
\end{enumerate}
\end{frame}

\begin{frame}{第2回: 行列式, トレース}
\begin{enumerate}
  \setcounter{enumi}{3}
  \item 以下のように示せる.
  最後の式変形では, ブロック下三角行列の関係を用いる.
  \begin{align*}
    \det\left( \mqty(\vb{A} & \vb{B} \\ \vb{B} & \vb{A}) \right)
      &= \det\left( \mqty(\vb{A} - \vb{B} & \vb{B} - \vb{A} \\ \vb{B} & \vb{A}) \right) \\
      &= \det\left( \mqty(\vb{A} - \vb{B} & \vb{0} \\ \vb{B} & \vb{A} + \vb{B}) \right) \\
      &= \det\left( \vb{A} - \vb{B} \right) \det\left( \vb{A} + \vb{B} \right)
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第2回: 行列式, トレース}
\begin{enumerate}
  \setcounter{enumi}{4}
  \item $\left( \adj \vb{A} \right) \vb{A}$の$(i, j)$要素は, 次のようになる.
  $\delta_{ij}$は, クロネッカーのデルタである.
  余因子行列$\adj \vb{A}$の$(i, k)$要素は, $\vb{A}$の$(k, i)$余因子$\Delta_{ki}$となることに注意する.
  \begin{align*}
    \left( \left( \adj \vb{A} \right) \vb{A} \right)_{ij}
      &= \sum_k \left( \adj \vb{A} \right)_{ik} a_{kj}
      = \sum_k \Delta_{ki} a_{kj} \\
      &= \delta_{ij} \det(\vb{A}) = \left( \det(\vb{A}) \vb{I} \right)_{ij}
  \end{align*}
  \item トレースの循環性を用いる.
  \begin{align*}
    \tr(\vb{X}^{-1} \vb{A} \vb{X}) = \tr(\vb{A} \vb{X} \vb{X}^{-1}) = \tr(\vb{A})
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第3回: 行列とベクトルの微分1}
\begin{enumerate}
  \item 以下のようになる ($\vb{x}$は$n$次, $\vb{y}$は$m$次縦ベクトル).
  \begin{table}[h]
    \centering
    \begin{tabular}{ScScSc} \hline
      & 分子レイアウト & 分母レイアウト \\ \hline
      $\displaystyle \pdv{\vb{y}}{x}$ & $m \times 1$ & $1 \times m$ \\
      $\displaystyle \pdv{y}{\vb{x}}$ & $1 \times n$ & $n \times 1$ \\
      $\displaystyle \pdv{\vb{y}}{\vb{x}}$ & $m \times n$ & $n \times m$ \\ \hline
    \end{tabular}
  \end{table}

  \item 省略.
  \item 省略.
  \item 省略.
\end{enumerate}
\end{frame}

\begin{frame}{第3回: 行列とベクトルの微分1}
\begin{enumerate}
  \setcounter{enumi}{4}
  \item 省略.
  \item 省略.
  \item 以下のようになる.
  \begin{align*}
    \pdv{\vb{A} \vb{u}}{x} &= \pdv{\vb{u}}{x} \vb{A}^\top \\
    \pdv{\left( \vb{A} \vb{x} + \vb{b} \right)^\top \vb{C} \left( \vb{D} \vb{x} + \vb{e} \right)}{\vb{x}}
      &= \vb{A}^\top \vb{C} \left( \vb{D} \vb{x} + \vb{e} \right)
        + \vb{D}^\top \vb{C}^\top \left( \vb{A} \vb{x} + \vb{b} \right) \\
    \pdv{\left( \vb{x} - \vb{b} \right)^\top \vb{C} \left( \vb{x} - \vb{b} \right)}{\vb{x}}
      &= 2 \vb{C}^\top \left( \vb{x} - \vb{b} \right) \\
    \pdv{\vb{g}(\vb{u})}{\vb{x}} &= \pdv{\vb{u}}{\vb{x}} \pdv{\vb{g}(\vb{u})}{\vb{u}}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第4回: 行列とベクトルの微分2}
\begin{enumerate}
  \item $\displaystyle \pdv{\vb{R}(\theta)^{-1}}{\theta}$を2通りの方法で求めると, 以下のようになる.
  \begin{align*}
    \pdv{\vb{R}(\theta)^{-1}}{\theta}
      &= \pdv{\theta} \mqty(\cos \theta & \sin \theta \\ -\sin \theta & \cos \theta)
      = \mqty(-\sin \theta & \cos \theta \\ -\cos \theta & -\sin \theta) \\
    \pdv{\vb{R}(\theta)^{-1}}{\theta}
      &= - \vb{R}(\theta)^{-1} \pdv{\vb{R}(\theta)}{\theta} \vb{R}(\theta)^{-1} \\
      &= - \mqty(\cos \theta & \sin \theta \\ -\sin \theta & \cos \theta)
        \pdv{\theta} \mqty(\cos \theta & -\sin \theta \\ \sin \theta & \cos \theta)
        \mqty(\cos \theta & \sin \theta \\ -\sin \theta & \cos \theta) \\
      &= - \mqty(\cos \theta & \sin \theta \\ -\sin \theta & \cos \theta)
        \mqty(-\sin \theta & -\cos \theta \\ \cos \theta & -\sin \theta)
        \mqty(\cos \theta & \sin \theta \\ -\sin \theta & \cos \theta) \\
      &= - \mqty(0 & -1 \\ 1 & 0) \mqty(\cos \theta & \sin \theta \\ -\sin \theta & \cos \theta)
      = \mqty(-\sin \theta & \cos \theta \\ -\cos \theta & -\sin \theta)
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第4回: 行列とベクトルの微分2}
\begin{enumerate}
  \setcounter{enumi}{1}
  \item 次のようになる.
  \begin{align*}
    \pdv{\vb{x}'}{\vb{x}} &= \mqty(\pdv{x'}{x} & \pdv{x'}{y} & \pdv{x'}{\theta} \\
      \pdv{y'}{x} & \pdv{y'}{y} & \pdv{y'}{\theta} \\
      \pdv{\theta'}{x} & \pdv{\theta'}{y} & \pdv{\theta'}{\theta})
      = \mqty(1 & 0 & -u \sin \theta - v \cos \theta \\
        0 & 1 & u \cos \theta - v \sin \theta \\ 0 & 0 & 1) \\
    \pdv{\vb{x}'}{\vb{u}} &= \mqty(\pdv{x'}{u} & \pdv{x'}{v} & \pdv{x'}{\omega} \\
      \pdv{y'}{u} & \pdv{y'}{v} & \pdv{y'}{\omega} \\
      \pdv{\theta'}{u} & \pdv{\theta'}{v} & \pdv{\theta'}{\omega})
      = \mqty(\cos \theta & -\sin \theta & 0 \\
        \sin \theta & \cos \theta & 0 \\ 0 & 0 & 1)
      = \mqty(\vb{R}(\theta) & \vb{0} \\ \vb{0}^\top & 1)
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第4回: 行列とベクトルの微分2}
\begin{enumerate}
  \setcounter{enumi}{2}
  \item 次のように, 要素ごとに確認できる.
  {\small \begin{align*}
    & \left( \pdv{\left( \vb{X}^\top \vb{a} \right)^\top \vb{X}^\top \vb{b}}{\vb{X}} \right)_{ij}
      = \pdv{\left( \vb{X}^\top \vb{a} \right)^\top \vb{X}^\top \vb{b}}{x_{ji}}
      = \pdv{x_{ji}} \sum_k \left( \vb{X}^\top \vb{a} \right)_k \left( \vb{X}^\top \vb{b} \right)_k \\
      &= \pdv{x_{ji}} \sum_k \left( \sum_l x_{lk} a_l \right) \left( \sum_m x_{mk} b_m \right) \\
      &= \sum_k \sum_l a_l \sum_m b_m
        \left( x_{mk} \pdv{x_{lk}}{x_{ji}} + x_{lk} \pdv{x_{mk}}{x_{ji}} \right) \\
      &= \sum_k \sum_l a_l \sum_m b_m
        \left( x_{mk} \delta_{lj} \delta_{ki} + x_{lk} \delta_{mj} \delta_{ki} \right) \\
      &= a_j \sum_m b_m x_{mi} + b_j \sum_l a_l x_{li}
      = a_j \left( \vb{X}^\top \vb{b} \right)_i + b_j \left( \vb{X}^\top \vb{a} \right)_i \\
      &= \left( \vb{X}^\top \vb{b} \vb{a}^\top \right)_{ij}
        + \left( \vb{X}^\top \vb{a} \vb{b}^\top \right)_{ij}
      = \left( \vb{X}^\top \vb{b} \vb{a}^\top + \vb{X}^\top \vb{a} \vb{b}^\top \right)_{ij}
  \end{align*}}
\end{enumerate}
\end{frame}

\begin{frame}{第4回: 行列とベクトルの微分2}
\begin{enumerate}
  \setcounter{enumi}{3}
  \item 次のように, 要素ごとに確認できる.
  \begin{align*}
    & \left( \pdv{\tr(\vb{X}^\top \vb{X} \vb{A})}{\vb{X}} \right)_{ij}
      = \pdv{\tr(\vb{X}^\top \vb{X} \vb{A})}{x_{ji}}
      = \pdv{x_{ji}} \sum_k \left( \vb{X}^\top \vb{X} \vb{A} \right)_{kk} \\
      &= \pdv{x_{ji}} \sum_k \sum_l x_{lk} \left( \vb{X} \vb{A} \right)_{lk}
      = \pdv{x_{ji}} \sum_k \sum_l x_{lk} \sum_m x_{lm} a_{mk} \\
      &= \sum_k \sum_l \sum_m a_{mk} \left( x_{lm} \pdv{x_{lk}}{x_{ji}}
        + x_{lk} \pdv{x_{lm}}{x_{ji}} \right) \\
      &= \sum_k \sum_l \sum_m a_{mk} \left( \delta_{ki} \delta_{lj} x_{lm}
        + \delta_{lj} \delta_{mi} x_{lk} \right) \\
      &= \sum_m a_{mi} x_{jm} + \sum_k a_{ik} x_{jk}
      = \left( \vb{A}^\top \vb{X}^\top \right)_{ij} + \left( \vb{A} \vb{X}^\top \right)_{ij}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第4回: 行列とベクトルの微分2}
\begin{enumerate}
  \setcounter{enumi}{4}
  \item 次のように, 要素ごとに確認できる.
  \begin{align*}
    & \pdv{\tr(\vb{A} \vb{X} \vb{B} \vb{X}^\top \vb{C})}{\vb{X}}
      = \pdv{\tr(\vb{X} \vb{B} \vb{X}^\top \vb{C} \vb{A})}{\vb{X}} \quad (\because \text{循環性}) \\
      &= \vb{B} \vb{X}^\top \left( \vb{C} \vb{A} \right)
        + \vb{B}^\top \vb{X}^\top \left( \vb{C} \vb{A} \right)^\top \quad (\because \text{文字の置き換え}) \\
      &= \vb{B} \vb{X}^\top \vb{C} \vb{A} + \vb{B}^\top \vb{X}^\top \vb{A}^\top \vb{C}^\top \\
      &= \left( \vb{A}^\top \vb{C}^\top \vb{X} \vb{B}^\top + \vb{C} \vb{A} \vb{X} \vb{B} \right)^\top
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第4回: 行列とベクトルの微分2}
\begin{enumerate}
  \setcounter{enumi}{5}
  \item 次のようになる. 合成関数の微分, 逆行列の微分を用いる.
  $\vb{Z} = \vb{Y}^{-1} \vb{A} + \vb{B}$とおいて,
  \begin{align*}
    & \pdv{\left( \vb{Y}^{-1} \vb{A} + \vb{B} \right)^{-1}
      \vb{C} \left( \vb{Y}^{-1} \vb{A} + \vb{B} \right)^{-1}}{x} \\
      &= \pdv{\vb{Z}^{-1} \vb{C} \vb{Z}^{-1}}{x}
      = \pdv{\vb{Z}^{-1}}{x} \vb{C} \vb{Z}^{-1} + \vb{Z}^{-1} \vb{C} \pdv{\vb{Z}^{-1}}{x} \\
      &= -\vb{Z}^{-1} \pdv{\vb{Z}}{x} \vb{Z}^{-1} \vb{C} \vb{Z}^{-1}
        - \vb{Z}^{-1} \vb{C} \vb{Z}^{-1} \pdv{\vb{Z}}{x} \vb{Z}^{-1} \\
      &= -\vb{Z}^{-1} \left( \pdv{\vb{Z}}{x} \vb{Z}^{-1} \vb{C} + \vb{C} \vb{Z}^{-1} \pdv{\vb{Z}}{x} \right) \vb{Z}^{-1}
  \end{align*}
  $\pdv{\vb{Z}}{x}$は以下のようになるから,
  \begin{align*}
    \pdv{\vb{Z}}{x} = \pdv{\vb{Y}^{-1} \vb{A} + \vb{B}}{x}
      = \pdv{\vb{Y}^{-1}}{x} \vb{A}
      = -\vb{Y}^{-1} \pdv{\vb{Y}}{x} \vb{Y}^{-1} \vb{A}
  \end{align*}
  次が得られる.
  \begin{align*}
    & \pdv{\left( \vb{Y}^{-1} \vb{A} + \vb{B} \right)^{-1}
      \vb{C} \left( \vb{Y}^{-1} \vb{A} + \vb{B} \right)^{-1}}{x} \\
    &= \left( \vb{Y}^{-1} \vb{A} + \vb{B} \right)^{-1}
      \bigg( \vb{Y}^{-1} \pdv{\vb{Y}}{x} \vb{Y}^{-1} \vb{A}
      \left( \vb{Y}^{-1} \vb{A} + \vb{B} \right)^{-1} \vb{C} \\
      & \quad + \vb{C} \left( \vb{Y}^{-1} \vb{A} + \vb{B} \right)^{-1}
      \vb{Y}^{-1} \pdv{\vb{Y}}{x} \vb{Y}^{-1} \vb{A} \bigg)
      \left( \vb{Y}^{-1} \vb{A} + \vb{B} \right)^{-1}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第4回: 行列とベクトルの微分2}
\begin{enumerate}
  \setcounter{enumi}{6}
  \item 次のように示せる.
  \begin{align*}
    \pdv{\exp(x \vb{A})}{x} &= \pdv{x} \sum_{n = 0}^\infty \frac{1}{n!} \left( x \vb{A} \right)^n
      = \sum_{n = 1}^\infty \frac{1}{n!} n x^{n - 1} \vb{A}^n \\
      &= \sum_{n = 1}^\infty \frac{1}{(n - 1)!} x^{n - 1} \vb{A}^n
      = \sum_{n = 0}^\infty \frac{1}{n!} x^n \vb{A}^{n + 1} \\
      &= \left( \sum_{n = 0}^\infty \frac{1}{n!} x^n \vb{A}^n \right) \vb{A}
      = \vb{A} \left( \sum_{n = 0}^\infty \frac{1}{n!} x^n \vb{A}^n \right) \\
      &= \exp(x \vb{A}) \vb{A} = \vb{A} \exp(x \vb{A})
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第5回: 行列とベクトルの微分3}
\begin{enumerate}
  \item 次のように示せる. $\vb{Y} = a \vb{X}$とおいて, 各成分について確かめると,
  {\small \begin{align*}
    \left( \pdv{\det(a \vb{X})}{\vb{X}} \right)_{ij}
      &= \pdv{\det(\vb{Y})}{x_{ji}}
      = \tr(\pdv{\det(\vb{Y})}{\vb{Y}} \pdv{\vb{Y}}{x_{ji}}) \\
      &= \det(\vb{Y}) \tr(\vb{Y}^{-1} \pdv{a \vb{X}}{x_{ji}})
      = \det(a \vb{X}) \tr(a^{-1} \vb{X}^{-1} a \vb{J}^{ji}) \\
      &= \det(a \vb{X}) \tr(\vb{X}^{-1} \vb{J}^{ji})
      = \det(a \vb{X}) \sum_k \left( \vb{X}^{-1} \vb{J}^{ji} \right)_{kk} \\
      &= \det(a \vb{X}) \sum_k \sum_l \left( \vb{X}^{-1} \right)_{kl} \left( \vb{J}^{ji} \right)_{lk} \\
      &= \det(a \vb{X}) \sum_k \sum_l \left( \vb{X}^{-1} \right)_{kl} \delta_{ik} \delta_{jl}
      = \det(a \vb{X}) \left( \vb{X}^{-1} \right)_{ij}
  \end{align*}}
  ただし, 以下を用いている.
  {\small \begin{align*}
    \pdv{\vb{X}}{x_{ji}} = \vb{J}^{ji}, \quad
    \left( \vb{J}^{ji} \right)_{lk} = \delta_{ik} \delta_{jl}, \quad
    \pdv{g(\vb{U})}{x_{ij}} = \tr(\pdv{g(\vb{U})}{\vb{U}} \pdv{\vb{U}}{x_{ij}})
  \end{align*}}
\end{enumerate}
\end{frame}

\begin{frame}{第5回: 行列とベクトルの微分3}
\begin{enumerate}
  \setcounter{enumi}{1}
  \item 次のように示せる.
  \begin{align*}
    \pdv{\det(\vb{A} \vb{X} \vb{B})}{\vb{X}} &= \det(\vb{A}) \det(\vb{B}) \pdv{\det(\vb{X})}{\vb{X}} \\
      &= \det(\vb{A}) \det(\vb{B}) \det(\vb{X}) \vb{X}^{-1} \\
      &= \det(\vb{A} \vb{X} \vb{B}) \vb{X}^{-1}
  \end{align*}

  \item 省略.
\end{enumerate}
\end{frame}

\begin{frame}{第5回: 行列とベクトルの微分3}
\begin{enumerate}
  \setcounter{enumi}{3}
  \item 次のようになる.
  {\small \begin{align*}
    \pdv{\det(\vb{R}(\theta))}{\theta}
      &= \pdv{\theta} \det \left( \mqty(\cos \theta & -\sin \theta \\ \sin \theta & \cos \theta) \right)
      = \pdv{\theta} \left( \cos^2 \theta + \sin^2 \theta \right) = 0
  \end{align*}}
  また,
  {\small \begin{align*}
    & \det(\vb{R}(\theta)) \tr(\vb{R}(\theta)^{-1} \pdv{\vb{R}(\theta)}{\theta}) \\
      &= 1 \cdot \tr \left( \mqty(\cos \theta & \sin \theta \\ -\sin \theta & \cos \theta)
        \pdv{\theta} \mqty(\cos \theta & -\sin \theta \\ \sin \theta & \cos \theta) \right) \\
      &= \tr \left( \mqty(\cos \theta & \sin \theta \\ -\sin \theta & \cos \theta)
        \mqty(-\sin \theta & -\cos \theta \\ \cos \theta & -\sin \theta) \right) \\
      &= \tr \left( \mqty(0 & -1 \\ 1 & 0) \right) = 0
  \end{align*}}
\end{enumerate}
\end{frame}

\begin{frame}{第5回: 行列とベクトルの微分3}
\begin{enumerate}
  \setcounter{enumi}{4}
  \item 次のように示せる.
  合成関数の微分, 逆行列の微分を思い出そう.
  \begin{align*}
    \pdv{\vb{U}^\dagger}{x} &\equiv
      \pdv{\left( \vb{U}^\top \vb{U} \right)^{-1} \vb{U}^\top}{x} \\
    &= \pdv{\left( \vb{U}^\top \vb{U} \right)^{-1}}{x} \vb{U}^\top
      + \left( \vb{U}^\top \vb{U} \right)^{-1} \pdv{\vb{U}^\top}{x} \\
    &= -\left( \vb{U}^\top \vb{U} \right)^{-1}
      \pdv{\vb{U}^\top \vb{U}}{x} \left( \vb{U}^\top \vb{U} \right)^{-1} \vb{U}^\top
      + \left( \vb{U}^\top \vb{U} \right)^{-1} \pdv{\vb{U}^\top}{x} \\
    &= -\left( \vb{U}^\top \vb{U} \right)^{-1}
      \pdv{\vb{U}^\top}{x} \vb{U} \left( \vb{U}^\top \vb{U} \right)^{-1} \vb{U}^\top \\
    & \quad - \left( \vb{U}^\top \vb{U} \right)^{-1} \vb{U}^\top
      \pdv{\vb{U}}{x} \left( \vb{U}^\top \vb{U} \right)^{-1} \vb{U}^\top
      + \left( \vb{U}^\top \vb{U} \right)^{-1} \pdv{\vb{U}^\top}{x} \\
    &= -\left( \vb{U}^\top \vb{U} \right)^{-1} \pdv{\vb{U}^\top}{x} \vb{U} \vb{U}^\dagger
      - \vb{U}^\dagger \pdv{\vb{U}}{x} \vb{U}^\dagger
      + \left( \vb{U}^\top \vb{U} \right)^{-1} \pdv{\vb{U}^\top}{x}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第5回: 行列とベクトルの微分3}
\begin{enumerate}
  \setcounter{enumi}{5}
  \item 最初に, ガウス分布$\mathcal{N}(\vb{x} \mid \vb*{\mu}, \vb{\Sigma})$の対数を調べる:
  \begin{align*}
    \ln \mathcal{N}(\vb{x} \mid \vb*{\mu}, \vb{\Sigma})
    &= -\frac{D}{2} \ln(2\pi) - \frac{1}{2} \ln(\det \vb{\Sigma})
      - \frac{1}{2} \left( \vb{x} - \vb*{\mu} \right)^\top \vb{\Sigma}^{-1}
        \left( \vb{x} - \vb*{\mu} \right)
  \end{align*}
  平均$\vb*{\mu}$についての微分は,
  \begin{align*}
    \pdv{\vb*{\mu}} \ln \mathcal{N}(\vb{x} \mid \vb*{\mu}, \vb{\Sigma})
    &= -\left( \vb{x} - \vb*{\mu} \right)^\top \vb{\Sigma}^{-1}
  \end{align*}
  \newpage
  共分散の逆行列$\vb{\Sigma}^{-1}$についての微分は,
  \begin{align*}
    & \pdv{\vb{\Sigma}^{-1}} \ln \mathcal{N}(\vb{x} \mid \vb*{\mu}, \vb{\Sigma}) \\
    &= -\frac{1}{2} \pdv{\vb{\Sigma}^{-1}} \ln(\det \vb{\Sigma})
      - \frac{1}{2} \pdv{\vb{\Sigma}^{-1}}
      \left( \vb{x} - \vb*{\mu} \right)^\top \vb{\Sigma}^{-1}
      \left( \vb{x} - \vb*{\mu} \right) \\
    &= \frac{1}{2} \pdv{\vb{\Sigma}^{-1}} \ln(\frac{1}{\det \vb{\Sigma}})
      - \frac{1}{2} \left( \vb{x} - \vb*{\mu} \right) \left( \vb{x} - \vb*{\mu} \right)^\top \\
    &= \frac{1}{2} \pdv{\vb{\Sigma}^{-1}} \ln(\det \vb{\Sigma}^{-1})
      - \frac{1}{2} \left( \vb{x} - \vb*{\mu} \right) \left( \vb{x} - \vb*{\mu} \right)^\top \\
    &= \frac{1}{2} \vb{\Sigma}
      - \frac{1}{2} \left( \vb{x} - \vb*{\mu} \right) \left( \vb{x} - \vb*{\mu} \right)^\top \\
    &= \frac{1}{2} \left( \vb{\Sigma}
      - \left( \vb{x} - \vb*{\mu} \right) \left( \vb{x} - \vb*{\mu} \right)^\top \right)
  \end{align*}
  \newpage
  共分散$\vb{\Sigma}$についての微分は,
  \begin{align*}
    & \pdv{\vb{\Sigma}} \ln \mathcal{N}(\vb{x} \mid \vb*{\mu}, \vb{\Sigma}) \\
    &= -\frac{1}{2} \pdv{\vb{\Sigma}} \ln(\det \vb{\Sigma}) - \frac{1}{2} \pdv{\vb{\Sigma}}
      \left( \vb{x} - \vb*{\mu} \right)^\top \vb{\Sigma}^{-1}
      \left( \vb{x} - \vb*{\mu} \right) \\
    &= -\frac{1}{2} \vb{\Sigma}^{-1} - \frac{1}{2} \pdv{\vb{\Sigma}} \tr(
      \left( \vb{x} - \vb*{\mu} \right)^\top \vb{\Sigma}^{-1}
      \left( \vb{x} - \vb*{\mu} \right)) \\
    &= -\frac{1}{2} \vb{\Sigma}^{-1} - \frac{1}{2} \pdv{\vb{\Sigma}} \tr(
      \left( \vb{x} - \vb*{\mu} \right) \left( \vb{x} - \vb*{\mu} \right)^\top
      \vb{\Sigma}^{-1}) \\
    &= -\frac{1}{2} \vb{\Sigma}^{-1} + \frac{1}{2} \vb{\Sigma}^{-1}
      \left( \vb{x} - \vb*{\mu} \right) \left( \vb{x} - \vb*{\mu} \right)^\top
      \vb{\Sigma}^{-1} \\
    &= -\frac{1}{2} \vb{\Sigma}^{-1} \left( \vb{I}
      - \left( \vb{x} - \vb*{\mu} \right) \left( \vb{x} - \vb*{\mu} \right)^\top
      \vb{\Sigma}^{-1} \right)
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第6回: 確率分布, ガウス積分}
\begin{enumerate}
  \item 変数$\vb{x}$と, ある定数$\vb{A}$について, 次が成り立つことを, 要素ごとに確認してください.
  \begin{align*}
    \E{\vb{A} \vb{x}} = \vb{A} \E{\vb{x}}, \quad
    \E{\vb{x} \vb{A}} = \E{\vb{x}} \vb{A}
  \end{align*}
  $\vb{A}$の$(i, j)$成分を$a_{ij}$とする.
  $\E{\vb{A} \vb{x}}$の第$i$成分は,
  \begin{align*}
    \left( \E{\vb{A} \vb{x}} \right)_i = \E{\sum_j a_{ij} x_j}
      = \sum_j \E{a_{ij} x_j} = \sum_j a_{ij} \E{x_j} = \left( \vb{A} \E{\vb{x}} \right)_i
  \end{align*}
  より, $\vb{A} \E{\vb{x}}$の第$i$成分に等しいので, 最初の式が成り立つ. \\
  ただし, $\E{x + y} = \E{x} + \E{y}$, $\E{ax} = a \E{x}$を用いた.
  $\E{\vb{x} \vb{A}} = \E{\vb{x}} \vb{A}$についても同様に示せる.
\end{enumerate}
\end{frame}

\begin{frame}{第6回: 確率分布, ガウス積分}
\begin{enumerate}
  \setcounter{enumi}{1}
  \item 確率分布$p(\vb{x})$の共分散が$\vb{\Sigma} = \Var{\vb{x}}$であるとき,
  $\vb{y} = \vb{A} \vb{x}$の分布$p(\vb{y})$の共分散が$\vb{A} \vb{\Sigma} \vb{A}^\top$となることを示してください. \\
  次のように示せる:
  \begin{align*}
    \Var{\vb{y}}
    &= \E{\left( \vb{y} - \E{\vb{y}} \right) \left( \vb{y} - \E{\vb{y}} \right)^\top} \\
    &= \E{\left( \vb{A} \vb{x} - \E{\vb{A} \vb{x}} \right)
      \left( \vb{A} \vb{x} - \E{\vb{A} \vb{x}} \right)^\top} \\
    &= \E{\vb{A} \left( \vb{x} - \E{\vb{x}} \right) \left( \vb{x} - \E{\vb{x}} \right)^\top \vb{A}^\top} \\
    &= \vb{A} \E{\left( \vb{x} - \E{\vb{x}} \right) \left( \vb{x} - \E{\vb{x}} \right)^\top} \vb{A}^\top
    = \vb{A} \vb{\Sigma} \vb{A}^\top
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第6回: 確率分布, ガウス積分}
\begin{enumerate}
  \setcounter{enumi}{2}
  \item 確率分布$p(\vb{x})$の共分散$\vb{\Sigma} = \Var{\vb{x}}$について, 次が成り立つことを示してください.
  \begin{align*}
    \vb{\Sigma} &= \Var{\vb{x}} = \E{\vb{x} \vb{x}^\top} - \E{\vb{x}} \E{\vb{x}}^\top
      = \E{\vb{x} \vb{x}^\top} - \vb*{\mu} \vb*{\mu}^\top
  \end{align*}
  次のように示せる:
  \begin{align*}
    \vb{\Sigma} &= \E{\left( \vb{x} - \vb*{\mu} \right) \left( \vb{x} - \vb*{\mu} \right)^\top} \\
      &= \E{\vb{x} \vb{x}^\top} - \E{\vb{x} \vb*{\mu}^\top}
        - \E{\vb*{\mu} \vb{x}^\top} + \E{\vb*{\mu} \vb*{\mu}^\top} \\
      &= \E{\vb{x} \vb{x}^\top} - \E{\vb{x}} \vb*{\mu}^\top
        - \vb*{\mu} \E{\vb{x}}^\top + \vb*{\mu} \vb*{\mu}^\top \\
      &= \E{\vb{x} \vb{x}^\top} - \vb*{\mu} \vb*{\mu}^\top
        - \vb*{\mu} \vb*{\mu}^\top + \vb*{\mu} \vb*{\mu}^\top \\
      &= \E{\vb{x} \vb{x}^\top} - \vb*{\mu} \vb*{\mu}^\top
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第6回: 確率分布, ガウス積分}
\begin{enumerate}
  \setcounter{enumi}{3}
  \item $\vb{x}, \vb{y}$が独立, すなわち$p(\vb{x}, \vb{y}) = p(\vb{x}) p(\vb{y})$であれば,
  無相関, すなわち$\E{\vb{x} \vb{y}^\top} = \E{\vb{x}} \E{\vb{y}}^\top$となることを示してください. \\
  次のように示せる:
  \begin{align*}
    \E{\vb{x} \vb{y}^\top} &= \iint \vb{x} \vb{y}^\top p(\vb{x}, \vb{y}) \dd{\vb{x}} \dd{\vb{y}} \\
      &= \iint \vb{x} \vb{y}^\top p(\vb{x}) p(\vb{y}) \dd{\vb{x}} \dd{\vb{y}} \, (\because \text{独立}) \\
      &= \int \vb{x} p(\vb{x}) \dd{\vb{x}} \int \vb{y}^\top p(\vb{y}) \dd{\vb{y}} \\
      &= \E{\vb{x}} \E{\vb{y}}^\top
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第6回: 確率分布, ガウス積分}
\begin{enumerate}
  \setcounter{enumi}{4}
  \item 次を示してください.
  \begin{align*}
    & \E{\left( \vb{A} \vb{x} + \vb{b} \right) \left( \vb{C} \vb{x} + \vb{d} \right)^\top} \\
    &= \vb{A} \Var{\vb{x}} \vb{C}^\top
    + \left( \vb{A} \E{\vb{x}} + \vb{b} \right)
      \left( \vb{C} \E{\vb{x}} + \vb{d} \right)^\top
  \end{align*}
  次のようになる:
  \begin{align*}
    & \E{\left( \vb{A} \vb{x} + \vb{b} \right) \left( \vb{C} \vb{x} + \vb{d} \right)^\top} \\
    &= \Cov{\vb{A} \vb{x} + \vb{b}}{\vb{C} \vb{x} + \vb{d}}
      + \E{\vb{A} \vb{x} + \vb{b}} \E{\vb{C} \vb{x} + \vb{d}}^\top \\
    &= \Cov{\vb{A} \vb{x}}{\vb{C} \vb{x}}
      + \left( \vb{A} \E{\vb{x}} + \vb{b} \right) \left( \vb{C} \E{\vb{x}} + \vb{d} \right)^\top \\
    &= \vb{A} \Cov{\vb{x}}{\vb{x}} \vb{C}^\top
      + \left( \vb{A} \E{\vb{x}} + \vb{b} \right) \left( \vb{C} \E{\vb{x}} + \vb{d} \right)^\top \\
    &= \vb{A} \Var{\vb{x}} \vb{C}^\top
      + \left( \vb{A} \E{\vb{x}} + \vb{b} \right) \left( \vb{C} \E{\vb{x}} + \vb{d} \right)^\top
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第6回: 確率分布, ガウス積分}
\begin{enumerate}
  \setcounter{enumi}{5}
  \item カルバック--ライブラーダイバージェンスが非負, すなわち$\KL{p}{q} \ge 0$となることを示してください. \\
  $-\ln x$は下に凸だから, イェンセンの不等式より ($\E{f(x)} \le f(\E{x})$)
  \begin{align*}
    \KL{p}{q} &= -\E{\ln \frac{q(\vb{x})}{p(\vb{x})}} \\
      &\ge -\ln \E{\frac{q(\vb{x})}{p(\vb{x})}} \\
      &= -\ln \int p(\vb{x}) \frac{q(\vb{x})}{p(\vb{x})} \dd{\vb{x}} \\
      &= -\ln \int q(\vb{x}) \dd{\vb{x}} = -\ln 1 = 0
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第6回: 確率分布, ガウス積分}
\begin{enumerate}
  \setcounter{enumi}{6}
  \item エントロピーと相互情報量に関する, 次の式を示してください.
  \begin{align*}
    \MutualInfo{\vb{x}, \vb{y}} &= \Entropy{\vb{x}} + \Entropy{\vb{y}} - \Entropy{\vb{x}, \vb{y}}
  \end{align*}
  次のように示せる:
  {\small \begin{align*}
    \MutualInfo{\vb{x}, \vb{y}} &= \iint p(\vb{x}, \vb{y})
      \ln \frac{p(\vb{x}, \vb{y})}{p(\vb{x}) p(\vb{y})} \dd{\vb{x}} \dd{\vb{y}} \\
      &= \iint p(\vb{x}, \vb{y}) \left( \ln p(\vb{x}, \vb{y}) - \ln p(\vb{x}) - \ln p(\vb{y}) \right)
        \dd{\vb{x}} \dd{\vb{y}} \\
      &= -\Entropy{\vb{x}, \vb{y}} - \int \ln p(\vb{x}) \int p(\vb{x}, \vb{y}) \dd{\vb{y}} \dd{\vb{x}}
        - \int \ln p(\vb{y}) \int p(\vb{x}, \vb{y}) \dd{\vb{x}} \dd{\vb{y}} \\
      &= -\Entropy{\vb{x}, \vb{y}} - \int p(\vb{x}) \ln p(\vb{x}) \dd{\vb{x}}
        - \int p(\vb{y}) \ln p(\vb{y}) \dd{\vb{y}} \\
      &= \Entropy{\vb{x}} + \Entropy{\vb{y}} - \Entropy{\vb{x}, \vb{y}}
  \end{align*}}
\end{enumerate}
\end{frame}

\begin{frame}{第6回: 確率分布, ガウス積分}
\begin{enumerate}
  \setcounter{enumi}{7}
  \item 次の積分を求めてください.
  \begin{align*}
    \int_0^\infty x^4 \exp(-a x^2) \dd{x}, \quad \int_0^\infty x^5 \exp(-a x^2) \dd{x}
  \end{align*}
  $I_n = \int_0^\infty x^n \exp(-a x^2) \dd{x}$とすると, $I_2 = \frac{1}{4} \sqrt{\frac{\pi}{a^3}}$,
  $I_3 = \frac{1}{2 a^2}$である.
  $I_{n + 2} = \frac{n + 1}{2a} I_n$の関係を使えば,
  \begin{align*}
    I_4 &= I_{2 + 2} = \frac{2 + 1}{2a} I_2 = \frac{3}{2a} \frac{1}{4} \sqrt{\frac{\pi}{a^3}}
      = \frac{3}{8} \sqrt{\frac{\pi}{a^5}} \\
    I_5 &= I_{3 + 2} = \frac{3 + 1}{2a} I_3 = \frac{4}{2a} \frac{1}{2 a^2}
      = \frac{1}{a^3}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第7回: ガウス分布1}
\begin{enumerate}
  \item 次の積分を計算してください:
  \begin{align*}
    \int_{-\infty}^\infty (x - \mu)^2
      \exp \left( -\frac{1}{2 \sigma^2} \left( x - \mu \right)^2 \right) \dd{x}
  \end{align*}
  $y = \frac{x - \mu}{\sqrt{2 \sigma^2}}$とすると,
  $x = \sqrt{2 \sigma^2} y + \mu, \dv{x}{y} = \sqrt{2 \sigma^2}$だから,
  \begin{align*}
    2 \sigma^2 \int_{-\infty}^\infty y^2 \exp \left( -y^2 \right) \dv{x}{y} \dd{y}
      &= 2 \sigma^2 \cdot \sqrt{2 \sigma^2}
        \underbrace{\int_{-\infty}^\infty y^2 \exp \left( -y^2 \right) \dd{y}}_{= \frac{1}{2} \sqrt{\pi}} \\
      &= 2 \sigma^2 \cdot \sqrt{2 \sigma^2} \frac{1}{2} \sqrt{\pi} \\
      &= \sigma^2 \sqrt{2 \pi \sigma^2}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第7回: ガウス分布1}
\begin{enumerate}
  \setcounter{enumi}{1}
  \item ガウス分布$\mathcal{N}(x \mid \mu, \sigma^2)$のモーメント母関数$M_X(t) = \E{\exp(tX)}$について,
  $\exp(\cdot)$の中身を平方完成させてください:
  \begin{align*}
    M_X(t) = \E{\exp(tX)} = \int_{-\infty}^\infty \frac{1}{\sqrt{2\pi \sigma^2}}
      \exp(tx -\frac{1}{2 \sigma^2} \left( x - \mu \right)^2) \dd{x}
  \end{align*}
  次のようになる:
  \begin{align*}
    tx - \frac{1}{2 \sigma^2} \left( x - \mu \right)^2
    &= -\frac{1}{2 \sigma^2} \left( x^2 - 2 \mu x - 2 \sigma^2 tx + \mu^2 \right) \\
    &= -\frac{1}{2 \sigma^2} \left( \left( x - \left( \mu + \sigma^2 t \right) \right)^2
      - 2 \mu \sigma^2 t - \sigma^4 t^2 \right) \\
    &= \left( \mu t + \frac{\sigma^2 t^2}{2} \right)
      -\frac{1}{2 \sigma^2} \left( x - \left( \mu + \sigma^2 t \right) \right)^2
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第7回: ガウス分布1}
\begin{enumerate}
  \setcounter{enumi}{2}
  \item モーメント母関数を使って, ガウス分布の平均と分散を求めてください.
  \begin{align*}
    \E{x} &= \left. \dv{t} \exp(\mu t + \frac{\sigma^2 t^2}{2}) \right|_{t = 0} \\
    \E{x^2} &= \left. \dv[2]{t} \exp(\mu t + \frac{\sigma^2 t^2}{2}) \right|_{t = 0} \\
    \Var{x} &= \E{x^2} - \E{x}^2
  \end{align*}

  \newpage
  平均は,
  \begin{align*}
    \E{x} &= \left. \dv{t} \exp(\mu t + \frac{\sigma^2 t^2}{2}) \right|_{t = 0} \\
      &= \left. \exp(\mu t + \frac{\sigma^2 t^2}{2}) \left( \mu + \sigma^2 t \right) \right|_{t = 0}
      = \mu
  \end{align*}
  分散は,
  \begin{align*}
    \E{x^2} &= \left. \dv[2]{t} \exp(\mu t + \frac{\sigma^2 t^2}{2}) \right|_{t = 0} \\
      &= \left. \exp(\mu t + \frac{\sigma^2 t^2}{2}) \sigma^2 +
        \exp(\mu t + \frac{\sigma^2 t^2}{2}) \left( \mu + \sigma^2 t \right)^2 \right|_{t = 0} \\
      &= \sigma^2 + \mu^2 \\
    \Var{x} &= \E{x^2} - \E{x}^2 = \sigma^2
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第7回: ガウス分布1}
\begin{enumerate}
  \setcounter{enumi}{3}
  \item ガウス分布$\mathcal{N}(\vb{x} \mid \vb*{\mu}, \vb{\Sigma})$の
  モーメント母関数$M_{\vb{X}}(\vb{t}) = \E{\exp(\vb{t}^\top \vb{X})}$について,
  $\exp(\cdot)$の中身を平方完成させてください:
  \begin{align*}
    & M_{\vb{X}}(\vb{t}) = \E{\exp(\vb{t}^\top \vb{x})} \\
    &= \frac{1}{\left( 2\pi \right)^\frac{D}{2} \sqrt{\det \vb{\Sigma}}}
      \int_{-\boldsymbol{\infty}}^{\boldsymbol{\infty}}
      \exp(-\frac{1}{2} \left( \vb{x} - \vb*{\mu} \right)^\top \vb{\Sigma}^{-1}
        \left( \vb{x} - \vb*{\mu} \right) + \vb{t}^\top \vb{x}) \dd{\vb{x}}
  \end{align*}
  最初に,
  {\small \begin{align*}
    & -\frac{1}{2} \left( \vb{x} - \vb*{\mu} \right)^\top \vb{\Sigma}^{-1}
      \left( \vb{x} - \vb*{\mu} \right) + \vb{t}^\top \vb{x} \\
    &= -\frac{1}{2} \left( \vb{x}^\top \vb{\Sigma}^{-1} \vb{x}
      - \vb*{\mu}^\top \vb{\Sigma}^{-1} \vb{x}
      - \vb{x}^\top \vb{\Sigma}^{-1} \vb*{\mu}
      + \vb*{\mu}^\top \vb{\Sigma}^{-1} \vb*{\mu} {\color{red} - 2 \vb{t}^\top \vb{x}} \right) \\
    &= -\frac{1}{2} \left( \vb{x}^\top \vb{\Sigma}^{-1} \vb{x}
      - \vb*{\mu}^\top \vb{\Sigma}^{-1} \vb{x} - {\color{red} \vb{t}^\top \vb{x}}
      - \vb{x}^\top \vb{\Sigma}^{-1} \vb*{\mu} - {\color{red} \vb{x}^\top \vb{t}}
      + \vb*{\mu}^\top \vb{\Sigma}^{-1} \vb*{\mu} \right)
  \end{align*}}
  平方根$\vb{\Sigma}^{\frac{1}{2}}, \vb{\Sigma}^{-\frac{1}{2}}$を使い (対称性に注意), さらに平方完成すると,
  {\small \begin{align*}
    & -\frac{1}{2} \left( \vb{x}^\top \vb{\Sigma}^{-1} \vb{x}
      - \vb*{\mu}^\top \vb{\Sigma}^{-1} \vb{x} - \vb{t}^\top \vb{x}
      - \vb{x}^\top \vb{\Sigma}^{-1} \vb*{\mu} - \vb{x}^\top \vb{t}
      + \vb*{\mu}^\top \vb{\Sigma}^{-1} \vb*{\mu} \right) \\
    &= -\frac{1}{2} \bigg( \vb{x}^\top \vb{\Sigma}^{-\frac{1}{2}} \vb{\Sigma}^{-\frac{1}{2}} \vb{x}
      - \left( \vb*{\mu}^\top \vb{\Sigma}^{-\frac{1}{2}} + \vb{t}^\top \vb{\Sigma}^{\frac{1}{2}} \right)
        \vb{\Sigma}^{-\frac{1}{2}} \vb{x} \\
    & \quad - \vb{x}^\top \vb{\Sigma}^{-\frac{1}{2}}
        \left( \vb{\Sigma}^{-\frac{1}{2}} \vb*{\mu} + \vb{\Sigma}^{\frac{1}{2}} \vb{t} \right)
      + \vb*{\mu}^\top \vb{\Sigma}^{-1} \vb*{\mu} \bigg) \\
    &= -\frac{1}{2} \bigg( \left( \vb{\Sigma}^{-\frac{1}{2}} \vb{x} \right)^\top
      \vb{\Sigma}^{-\frac{1}{2}} \vb{x}
      - \left( \vb{\Sigma}^{-\frac{1}{2}} \vb*{\mu} + \vb{\Sigma}^{\frac{1}{2}} \vb{t} \right)^\top
      \vb{\Sigma}^{-\frac{1}{2}} \vb{x} \\
    & \quad - \left( \vb{\Sigma}^{-\frac{1}{2}} \vb{x} \right)^\top
      \left( \vb{\Sigma}^{-\frac{1}{2}} \vb*{\mu} + \vb{\Sigma}^{\frac{1}{2}} \vb{t} \right)
      + \vb*{\mu}^\top \vb{\Sigma}^{-1} \vb*{\mu} \bigg) \quad \text{($\because$対称性)} \\
    &= -\frac{1}{2} \bigg( \left( \vb{\Sigma}^{-\frac{1}{2}} \vb{x}
      - \left( \vb{\Sigma}^{-\frac{1}{2}} \vb*{\mu} + \vb{\Sigma}^{\frac{1}{2}} \vb{t} \right) \right)^\top
      \left( \vb{\Sigma}^{-\frac{1}{2}} \vb{x}
      - \left( \vb{\Sigma}^{-\frac{1}{2}} \vb*{\mu} + \vb{\Sigma}^{\frac{1}{2}} \vb{t} \right) \right) \\
    & \quad - \vb*{\mu}^\top \vb{t} - \vb{t}^\top \vb*{\mu} - \vb{t}^\top \vb{\Sigma} \vb{t} \bigg)
  \end{align*}}
  これを整理すれば,
  {\small \begin{align*}
    & -\frac{1}{2} \bigg( \left( \vb{\Sigma}^{-\frac{1}{2}} \vb{x}
      - \left( \vb{\Sigma}^{-\frac{1}{2}} \vb*{\mu} + \vb{\Sigma}^{\frac{1}{2}} \vb{t} \right) \right)^\top
      \left( \vb{\Sigma}^{-\frac{1}{2}} \vb{x}
      - \left( \vb{\Sigma}^{-\frac{1}{2}} \vb*{\mu} + \vb{\Sigma}^{\frac{1}{2}} \vb{t} \right) \right) \\
    & \quad - \vb*{\mu}^\top \vb{t} - \vb{t}^\top \vb*{\mu} - \vb{t}^\top \vb{\Sigma} \vb{t} \bigg) \\
    &= -\frac{1}{2} \left( \vb{x}
      - \left( \vb*{\mu} + \vb{\Sigma} \vb{t} \right) \right)^\top \vb{\Sigma}^{-\frac{1}{2}}
      \vb{\Sigma}^{-\frac{1}{2}} \left( \vb{x}
      - \left( \vb*{\mu} + \vb{\Sigma} \vb{t} \right) \right)
      \quad \text{($\vb{\Sigma}^{-\frac{1}{2}}$をくくり出す)} \\
    & \quad + \vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t}
      \quad \text{($\because$ $\vb*{\mu}^\top \vb{t} = \vb{t}^\top \vb*{\mu}$)} \\
    &= -\frac{1}{2} \left( \vb{x} - \left( \vb*{\mu} + \vb{\Sigma} \vb{t} \right) \right)^\top \vb{\Sigma}^{-1}
      \left( \vb{x} - \left( \vb*{\mu} + \vb{\Sigma} \vb{t} \right) \right)
      + \vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t}
  \end{align*}}
\end{enumerate}
\end{frame}

\begin{frame}{第7回: ガウス分布1}
\begin{enumerate}
  \setcounter{enumi}{4}
  \item モーメント母関数を使って, 多変量ガウス分布の平均と共分散を求めてください.
  \begin{align*}
    \E{\vb{x}}^\top
    &= \left. \dv{\vb{t}} \exp(\vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t})
      \right|_{\vb{t} = \vb{0}} \\
    \E{\vb{x} \vb{x}^\top}
    &= \left. \frac{\dd[2]}{\dd{\vb{t}^\top} \dd{\vb{t}}}
      \exp(\vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t})
      \right|_{\vb{t} = \vb{0}} \\
    \Var{\vb{x}} &= \E{\vb{x} \vb{x}^\top} - \E{\vb{x}} \E{\vb{x}}^\top
  \end{align*}

  \newpage
  平均は,
  \begin{align*}
    \E{\vb{x}}^\top
    &= \left. \dv{\vb{t}} \exp(\vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t})
      \right|_{\vb{t} = \vb{0}} \\
    &= \left. \exp(\vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t})
      \dv{\vb{t}} \left( \vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t} \right)
      \right|_{\vb{t} = \vb{0}} \\
    &= \left. \exp(\vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t})
      \left( \vb*{\mu}^\top + \vb{t}^\top \vb{\Sigma} \right)
      \right|_{\vb{t} = \vb{0}} = \vb*{\mu}^\top
  \end{align*}

  \newpage
  分散は,
  \begin{align*}
    \E{\vb{x} \vb{x}^\top}
    &= \left. \frac{\dd[2]}{\dd{\vb{t}^\top} \dd{\vb{t}}}
      \exp(\vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t})
      \right|_{\vb{t} = \vb{0}} \\
    &= \pdv{\vb{t}^\top} \exp(\vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t})
      \left( \vb*{\mu}^\top + \vb{t}^\top \vb{\Sigma} \right) \\
    & \quad + \left. \exp(\vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t})
      \pdv{\vb{t}^\top} \left( \vb*{\mu}^\top + \vb{t}^\top \vb{\Sigma} \right)
      \right|_{\vb{t} = \vb{0}} \\
    &= \exp(\vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t})^2
      \left( \vb*{\mu} + \vb{\Sigma} \vb{t} \right)
      \left( \vb*{\mu}^\top + \vb{t}^\top \vb{\Sigma} \right) \\
    & \quad + \left. \exp(\vb*{\mu}^\top \vb{t} + \frac{1}{2} \vb{t}^\top \vb{\Sigma} \vb{t})
      \vb{\Sigma} \right|_{\vb{t} = \vb{0}}
    = \vb*{\mu} \vb*{\mu}^\top + \vb{\Sigma} \\
    \Var{\vb{x}} &= \E{\vb{x} \vb{x}^\top} - \E{\vb{x}} \E{\vb{x}}^\top
    = \vb*{\mu} \vb*{\mu}^\top + \vb{\Sigma} - \vb*{\mu} \vb*{\mu}^\top = \vb{\Sigma}
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第8回: ガウス分布2}
\begin{enumerate}
  \item $\vb{x}$, $\vb{y}$は互いに\textcolor{red}{独立}で,
  ガウス分布$\mathcal{N}(\vb*{\mu}_x, \vb{\Sigma}_{xx})$,
  $\mathcal{N}(\vb*{\mu}_y, \vb{\Sigma}_{yy})$に従うとき,
  和$\vb{z} = \vb{A} \vb{x} + \vb{B} \vb{y}$が次のガウス分布に従うことを示してください.
  \begin{align*}
    \vb{z} \sim \mathcal{N}(\vb{A} \vb*{\mu}_x + \vb{B} \vb*{\mu}_y,
      \vb{A} \vb{\Sigma}_{xx} \vb{A}^\top + \vb{B} \vb{\Sigma}_{yy} \vb{B}^\top)
  \end{align*}

  $\vb{x}, \vb{y}$は互いに独立だから, それらを線形変換した$\vb{A} \vb{x}$, $\vb{B} \vb{y}$も独立である.
  $\vb{x}, \vb{y}$はガウス分布に従うから, それらの線形変換$\vb{A} \vb{x}$, $\vb{B} \vb{y}$もまたガウス分布に従う.
  従って, 2つの和$\vb{z}$も, ガウス分布に従う.

  平均と分散は, 次のように求まる:
  \begin{align*}
    \E{\vb{z}} &= \E{\vb{A} \vb{x} + \vb{B} \vb{y}}
      = \vb{A} \E{\vb{x}} + \vb{B} \E{\vb{y}}
      = \vb{A} \vb*{\mu}_x + \vb{B} \vb*{\mu}_y \\
    \Var{\vb{z}} &= \Var{\vb{A} \vb{x}} + \Var{\vb{B} \vb{y}}
      + \Cov{\vb{A} \vb{x}}{\vb{B} \vb{y}} + \Cov{\vb{B} \vb{y}}{\vb{A} \vb{x}} \\
      &= \Var{\vb{A} \vb{x}} + \Var{\vb{B} \vb{y}}
      = \vb{A} \vb{\Sigma}_{xx} \vb{A}^\top + \vb{B} \vb{\Sigma}_{yy} \vb{B}^\top
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第8回: ガウス分布2}
\begin{enumerate}
  \setcounter{enumi}{1}
  \item $K$個の独立な確率変数$\vb{x}_k$があり, ガウス分布$\mathcal{N}(\vb*{\mu}_k, \vb{\Sigma}_k)$に従うとき,
  重み付き和$\vb{x} = \sum_k w_k \vb{x}_k$が, 次のガウス分布に従うことを示してください.
  \begin{align*}
    \vb{x} \sim \mathcal{N} \left( \sum_k w_k \vb*{\mu}_k, \sum_k w_k^2 \vb{\Sigma}_k \right)
  \end{align*}

  地道に導出してもよいが, スライドの例 (62--63ページ) について, $\vb{W}_k = w_k \vb{I}$とおけばよい.
\end{enumerate}
\end{frame}

\begin{frame}{第8回: ガウス分布2}
\begin{enumerate}
  \setcounter{enumi}{2}
  \item 次が成り立つことを示してください:
  \begin{align*}
    & \prod_k \exp(-\frac{1}{2} \left( \vb{G}_k \vb{x} - \vb*{\mu}_k \right)^\top
      \vb{\Sigma}_k^{-1} \left( \vb{G}_k \vb{x} - \vb*{\mu}_k \right)) \\
    & \qquad \propto \exp(-\frac{1}{2} \left( \vb{x} - \vb*{\mu} \right) \vb{\Sigma}^{-1}
      \left( \vb{x} - \vb*{\mu} \right))
  \end{align*}
  ただし,
  \begin{align*}
    \vb{\Sigma}^{-1} &= \sum_k \vb{G}_k^\top \vb{\Sigma}_k^{-1} \vb{G}_k \\
    \vb{\Sigma}^{-1} \vb*{\mu} &= \sum_k \vb{G}_k^\top \vb{\Sigma}_k^{-1} \vb*{\mu}_k
  \end{align*}

  スライドの例 (68--69ページ) を参考に, 導出してみてください.
\end{enumerate}
\end{frame}

\begin{frame}{第9回: ガウス分布3}
\begin{enumerate}
  \item ガンマ関数$\Gamma(x)$について, 部分積分により次を示してください:
  \begin{align*}
    \Gamma(x + 1) &= x \Gamma(x)
  \end{align*}
  次のように示せる:
  \begin{align*}
    \Gamma(x + 1) &= \int_0^\infty u^x \exp(-u) \dd{u} \\
      &= \left[ -u^x \exp(-u) \right]_0^\infty + \int_0^\infty x u^{x - 1} \exp(-u) \dd{u} \\
      &= x \int_0^\infty u^{x - 1} \exp(-u) \dd{u} = x \Gamma(x)
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第9回: ガウス分布3}
\begin{enumerate}
  \setcounter{enumi}{1}
  \item $D = 4, 5$次元超球の体積$V_D(r)$と表面積$S_D(r)$を求めてください.
  $D = 4$次元超球の体積と表面積は,
  \begin{align*}
    V_4(r) &= \frac{\pi^\frac{4}{2}}{\Gamma(\frac{4}{2} + 1)} r^4
      = \frac{\pi^2}{\Gamma(3)} r^4 = \frac{\pi^2}{2} r^4 \\
    S_4(r) &= \frac{2\pi^\frac{4}{2}}{\Gamma(\frac{4}{2})} r^{4 - 1}
      = \frac{2\pi^2}{\Gamma(2)} r^3 = 2\pi^2 r^3
  \end{align*}
  $D = 5$次元超球の体積と表面積は,
  \begin{align*}
    V_5(r) &= \frac{\pi^\frac{5}{2}}{\Gamma(\frac{5}{2} + 1)} r^5
      = \frac{\pi^\frac{5}{2}}{\frac{5}{2} \cdot \frac{3}{2} \cdot \Gamma(\frac{3}{2})} r^5
      = \frac{\pi^\frac{5}{2}}{\frac{5}{2} \cdot \frac{3}{2} \cdot \frac{\sqrt{\pi}}{2}} r^5
      = \frac{8\pi^2}{15} r^5 \\
    S_5(r) &= \frac{2\pi^\frac{5}{2}}{\Gamma(\frac{5}{2})} r^{5 - 1}
      = \frac{2\pi^\frac{5}{2}}{\frac{3}{2} \cdot \Gamma(\frac{3}{2})} r^4
      = \frac{2\pi^\frac{5}{2}}{\frac{3}{2} \cdot \frac{\sqrt{\pi}}{2}} r^4
      = \frac{8\pi^2}{3} r^4
  \end{align*}
\end{enumerate}
\end{frame}

\begin{frame}{第9回: ガウス分布3}
\begin{enumerate}
  \item $D = 2$次元のガウス分布$\mathcal{N}(\vb{x} \mid \vb{0}, \sigma^2 \vb{I})$について,
  次の積分を考えることにより, $\vb{x}$の半径$r = \left\| \vb{x} \right\|$に関する
  レイリー分布$p(r)$を導出してください.
  \begin{align*}
    1 = \int_{\boldsymbol{-\infty}}^{\boldsymbol{\infty}}
      \mathcal{N}(\vb{x} \mid \vb{0}, \sigma^2 \vb{I}) \dd{\vb{x}}
      = \int_0^\infty p(r) \dd{r}
  \end{align*}
  積分を, 次のように変数変換すればよい:
  \begin{align*}
    1 &= \int_{\boldsymbol{-\infty}}^{\boldsymbol{\infty}}
      \mathcal{N}(\vb{x} \mid \vb{0}, \sigma^2 \vb{I}) \dd{\vb{x}} \\
      &= \int_{\boldsymbol{-\infty}}^{\boldsymbol{\infty}}
      \frac{1}{2\pi \sigma^2} \exp(-\frac{1}{2 \sigma^2} \vb{x}^\top \vb{x}) \dd{\vb{x}} \\
      &= \int_{-\infty}^\infty \int_{-\infty}^\infty
        \frac{1}{2\pi \sigma^2} \exp(-\frac{1}{2\sigma^2} \left( x^2 + y^2 \right)) \dd{x} \dd{y}
  \end{align*}
  $x = r \cos \theta$, $y = r \sin \theta$とおくと, 積分範囲は$r \in [0, \infty)$, $\theta = [0, 2\pi]$となる.
  ヤコビ行列$\vb{J}$は,
  \begin{align*}
    \vb{J} &= \pdv{(x, y)}{(r, \theta)}
      = \mqty(\pdv{x}{r} & \pdv{x}{\theta} \\ \pdv{y}{r} & \pdv{y}{\theta})
      = \mqty(\cos \theta & -r \sin \theta \\ \sin \theta & r \cos \theta)
  \end{align*}
  ヤコビアン$\left| \det \vb{J} \right|$は,
  \begin{align*}
    \left| \det \vb{J} \right| &= \left|
      (r \cos^2 \theta + r \sin^2 \theta) \right| = r
  \end{align*}
  よって, $\dd{x} \dd{y} = r \dd{r} \dd{\theta}$と変数変換できる.
  \newpage
  先ほどの積分を続けると,
  \begin{align*}
    1 &= \int_{-\infty}^\infty \int_{-\infty}^\infty
      \frac{1}{2\pi \sigma^2} \exp(-\frac{1}{2\sigma^2} \left( x^2 + y^2 \right)) \dd{x} \dd{y} \\
      &= \int_0^\infty \int_0^{2\pi}
      \frac{1}{2\pi \sigma^2} \exp(-\frac{1}{2\sigma^2} r^2) r \dd{r} \dd{\theta} \\
      &= \int_0^\infty \frac{1}{\sigma^2} \exp(-\frac{1}{2\sigma^2} r^2) r \dd{r}
      = \int_0^\infty p(r) \dd{r}
  \end{align*}
  従って, レイリー分布$p(r)$は,
  \begin{align*}
    p(r) &= \frac{r}{\sigma^2} \exp(-\frac{1}{2\sigma^2} r^2)
  \end{align*}
\end{enumerate}
\end{frame}

\end{document}
